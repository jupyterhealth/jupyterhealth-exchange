# https://docs.github.com/en/actions/writing-workflows/quickstart
name: GitHub Actions Demo
run-name: is testing out GitHub Actions
on:
  push:
    branches: [feat/github-issue-48-django-test-coverage]

jobs:
  Explore-GitHub-Actions:
    runs-on: ubuntu-latest
    steps:
      - run: echo "Triggered by a ${{ github.event_name }} event."
      - run: echo "The workflow is running on ${{ runner.os }}."
      - run: echo "Branch name is ${{ github.ref }}."
      - run: echo "Repository name is ${{ github.repository }}."

      - name: Checkout code
        uses: actions/checkout@v4

      - run: echo "Repository cloned successfully."

      - name: Set up Python 3.x
        uses: actions/setup-python@v4
        with:
          python-version: 3.x

      - name: Install dependencies using Pipenv
        run: |
          pip install pipenv
          pipenv install --dev

      - name: Run Django tests
        run: |
          pipenv run python manage.py test --pattern="*_test.py" --verbosity=2 --failfast --keepdb --noinput --parallel 4
          pipenv run coverage run --source='.' manage.py test --pattern="*_test.py" --verbosity=2 --failfast --keepdb --noinput --parallel 4

      - run: echo "Django tests completed."